# Stock Portfolio Optimization Using Machine Learning

<img src="https://github.com/mekz-data/portfolio_optimization/blob/main/images/finance.png" height="300"> 

This project explores the use of machine learning techniques to develop an optimal stock portfolio. It was part of my Master's in Analytics at Georgia Tech. Due to academic integrity policies, detailed reports and code are not publicly shared. Below is a brief overview of the project's accomplishments.

## Project Overview:
- Achieved a Sharpe Ratio of 1.07 for the best-performing portfolio, surpassing the S&P 500's ratio of 0.83, indicating a favorable risk-adjusted return.
- Utilized dimensionality reduction via principal component analysis, feature engineering, and k-means clustering to enhance portfolio performance.
- Data was sourced from the Yahoo Finance API.
- Began with financial data from all S&P 500 companies, refining the dataset through a rigorous cleaning process.

## Code and Resources Used
**Python Version:** 3.4        
**Packages used:** pypfopt, seaborn, yfinance, plotly, pandas, numpy, matplotlib, scikit-learn        
**Paper:** [Inspiration for Project](https://github.com/mekz-data/portfolio_optimization/blob/main/Reference%20Paper.pdf)

## Explanation of Key Features
- **marketCap:** Total market value of a company's outstanding shares, calculated by multiplying the current share price by the total number of outstanding shares.
- **volume:** Number of shares traded during a given period, indicating the liquidity and activity level of a stock.
- **freeCashflow:** Cash generated by a company after accounting for capital expenditures.
- **grossProfits:** Difference between revenue and the cost of goods sold (COGS).
- **totalDebt:** All short-term and long-term liabilities a company owes to its creditors.
- **profitMargins:** Net income divided by revenue, indicating how much profit a company makes for every dollar of sales.
- **52WeekChange:** Percentage change in stock price over a one-year period.

## Data Cleaning
- Retrieved financial data for the S&P 500 from yfinance, with 12 companies missing data.
- Removed irrelevant columns such as addresses and board of directors, reducing columns from 132 to 36.
- Excluded stocks missing vital features like Volume, Profit Margin, and EBITDA.

## Exploratory Data Analysis
- Summary statistics revealed:
  - Standard deviation of market cap is 239 billion.
  - One stock had a 209% increase over the year.
  - Mean is much higher than the median for every statistic, indicating large outliers skewing the data.

- Principal Component Analysis indicated that 6 principal components account for 60% of the variance.       

<img src="https://github.com/mekz-data/portfolio_optimization/blob/main/images/PCA.png"> 
        
## Building the Optimal Portfolio
- Converted the target variable, 52 Week Change, to a binary variable indicating if the stock was positive or negative for the year.
- Employed Lasso and Ridge Regression along with Random Forest for feature selection, with LASSO significantly outperforming Ridge.

<img src="https://github.com/mekz-data/portfolio_optimization/blob/main/images/accuracy.png" height="300">

- Used KMeans clustering to identify the best stocks based on the calculated Sharpe Ratio.

<img src="https://github.com/mekz-data/portfolio_optimization/blob/main/images/sharpe_ratio.webp" height="200">

- The Sharpe Ratio is typically evaluated as: > 1 = acceptable, > 2 = very good, > 3 = excellent, though this depends on current market conditions.       
       
<img src = "https://github.com/mekz-data/portfolio_optimization/blob/main/images/Sharpe_fluct.png" height="350">

- That being the case, the S&P 500's Sharpe Ratio serves as the benchmark.
- Only portfolios with more than 5 and fewer than 100 stocks were considered practical.
- The best-performing portfolio achieved a Sharpe Ratio of 1.07, outperforming the S&P 500's 0.83.

## Takeaways
- Feature engineering and clustering are powerful tools for identifying high-performing portfolios, even in volatile markets.
- The project demonstrated the potential of machine learning to enhance investment strategies by optimizing risk-adjusted returns.
- While the Sharpe Ratio is a useful metric, it should be interpreted in the context of current market conditions.
- The approach used in this project can serve as a foundation for further exploration and refinement in portfolio optimization techniques.
