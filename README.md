# Portfolio Analysis Using Machine Learning

<!-- <img src="https://github.com/Huntsworth7/LendingClubClassification/blob/master/images/lending_club_logo.JPG"> -->

Exploring the use of machine learning techniques to develop an optimal stock portfolio. 


## Project Overview:
- Our best performing portfolio achieved a Sharpe Ratio of 1.07, surpassing the S&P 500's ratio of 0.83, indicating a favorable risk-adjusted return. 
- Performed dimensionality reduction via principal component analysis, feature engineering, and k-means clustering to achieve favorable results.    
- Data was acquired from the yahoo finance API. 
- Started with the companies on the S&P 500 and slowly culled them out. 

## Code and Resources Used
**Python Version:** 3.4<br>
**Packages used:** pypfopt, seaborn, yfinance, plotly, pandas, numpy, matplotlib, scikit-learn,.<br>
**Paper:** put link here

## Features
Highlights:
- **marketCap:** Total market value of a company's outstanding shares of stock. It's calculated by multiplying the current share price by the total number of outstanding shares.
- **volume:** The number of shares traded during a given period. It indicates the liquidity and activity level of a stock.
- **freeCashflow:** The amount of cash generated by a company after accounting for capital expenditures. 
- **grossProfits:** The difference between revenue and the cost of goods sold (COGS).
- **totalDebt:** Total debt includes all short-term and long-term liabilities a company owes to its creditors.
- **profitMargins:** Net income divided by revenue. It indicates how much profit a company makes for every dollar of sales.
- **52WeekChange:** Percentage change in stock price over a one year period.  

## Data Cleaning
- Pulled the S&P 500 from yfinance but 12 companies were missing data. Removed columns we deemed irrelant like "board of directors."
- Removed columns we deemed irrelant like "board of directors," reducing our columns from 132 down to 36. 
- Removed many stocks that were missing features that we thought would be important like Volume, Profit Margin, EBITDA etc. 

## EDA
- Notable findings of summary statistics:
- Standard dev of market cap is 239 billion.
- 1 stock had a 209% increase over the year.
- Mean is much higher than the median on every statistic, indicating that there are some large outliers at the top skewing the data.
- Performing PCA on our data we see that it only takes 6 principal components to comprise 60% of our variance.

<!--put PCA image here -->

## Building the Optimal Portfolio
- Changed the target variable 52 Week Change to a binary variable indicating if the stock was positive or negative for the year.
- Used Lasso and Ridge Regression along with Random Forest for feature selection. LASSO greatly outperformed Ridge.

<!-- put accuracy graph here -->

- KMeans clustering was used to find the best stocks according to the Sharpe Ratio

<!-- Put Sharpe Ratio Formula here -->


## Model Performance
Here's the ROC curve for all three classifiers. Gradient Boosting outperforms Random Forest by the slimmest of margins: <br><br>
<img src="https://github.com/Huntsworth7/LendingClubClassification/blob/master/images/roc_curve.JPG" width="540">

Hyperparameter Optimization was performed but did not yield any noticeable improvements.

## Takeaways
According to our model, the most important features for predicting a good loan are:
- borrowers with a high number of months since oldest revolving account opened
- lower loan amounts & payments
- a low number of total accounts
- higher annual incomes
- a high number of months since the most recent installment accounts were opened.

This project was a great learning experience. Looking at it again while updating this Readme, I see plenty of improvements or augmentations that I would make if I were working on it today. That being said, I am going to keep it as it is to act as my Data Science time capsule.
